<!DOCTYPE html>
<html dir="rtl" lang="he">
<!-- [Previous head and style sections remain the same] -->
<head>
    <meta charset="UTF-8">
    <title>מערכת בחינות</title>
    <style>
        /* [Previous styles remain the same] */
        .answer-key-table {
            width: 50%;
            margin: 20px auto;
            border-collapse: collapse;
        }
        .answer-key-table th, .answer-key-table td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- [Previous HTML content remains the same until the exportToWord function] -->
    <script>
        // [Previous functions remain the same until exportToWord]

        function exportToWord() {
            if (examData.length === 0) {
                alert('אנא הכנס שאלות תחילה');
                return;
            }

            let content = `<html dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: Arial, sans-serif; direction: rtl; }
                        .question { margin-bottom: 1em; }
                        .answer { margin-right: 2em; }
                        table { width: 50%; margin: 20px auto; border-collapse: collapse; }
                        th, td { border: 1px solid black; padding: 8px; text-align: center; }
                    </style>
                </head>
                <body>
                    <h1>מבחן</h1>`;

            examData.forEach((question, qIndex) => {
                content += `
                    <div class="question">
                        <p><strong>${qIndex + 1}. ${question.question}</strong></p>`;
                
                question.answers.forEach((answer, aIndex) => {
                    content += `<p class="answer">${letters[aIndex]}. ${answer}</p>`;
                });
                
                content += '</div>';
            });

            content += '<div style="page-break-before: always;"><h2>מפתח תשובות</h2>';
            content += '<table dir="rtl"><tr><th>מספר שאלה</th><th>תשובה נכונה</th></tr>';
            
            examData.forEach((question, qIndex) => {
                const correctIndex = question.answers.findIndex(a => a === question.correctAnswer);
                content += `<tr><td>${qIndex + 1}</td><td>${letters[correctIndex]}</td></tr>`;
            });
            
            content += '</table></div></body></html>';

            const blob = new Blob([content], { type: 'application/msword' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'מבחן.doc';
            link.click();
            URL.revokeObjectURL(link.href);
        }

        // [Rest of the code remains the same]
    </script>
</body>
</html>
